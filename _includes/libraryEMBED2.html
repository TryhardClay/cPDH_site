<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <link href="https://unpkg.com/tabulator-tables@5.4.3/dist/css/tabulator.min.css" rel="stylesheet">
    
  //<-- -->
    <script>
    function doGet() {
      const htmlService = HtmlService
       .createTemplateFromFile("library")
       .evaluate()
       .addMetaTag("viewport","width=device-width, initial-scale=1.0")
      return htmlService
}
    </script>
  
  //<-- -->
    <script>
    function getData() {
      const ss = SpreadsheetApp.getActiveSpreadsheet()
      const ws = ss.getSheetByName("cPDHLibrary")
      const dataRange = ws.getRange("A1").getDataRegion()
      const data = dataRange.getDisplayValues()
      const headers = data.shift()
      const jsData = data.map(r => {
      const tempObject = {}

    headers.forEach((header,i) => {
      tempObject[header] = r[i]
    })
    return tempObject
    })
    console.log(jsData)
    return jsData
    } //end getData function
    </script>  
   
  //<-- -->
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.4.3/dist/js/tabulator.min.js">
    </script>
  
  //<-- -->
    <script>
     document.addEventListener("DOMContentLoaded",pageLoad)
      function pageLoad(){
        loadData()
      }
      function loadData(){
        google.script.run
        .withSuccessHandler((jsData) => {
        // if data succesfully returned

        //create Tabulator on DOM element with id "data-table"
        const table = new Tabulator("#data-table", {
          height:515, // set height of table (in CSS or here)
          data:jsData, //assign data to table
          layout:"fitColumns", //fit columns to width of table (optional)
            pagination:true,
            paginationSize:19,
            initialSort:[
              {column:"COMMANDER", dir:"asc"},
            ],
          columns:[ //Define Table Columns
            {title:"COMMANDER(S)", field:"COMMANDER", width:375},
            {title:"LINK", field:"LINK"}
            {title:"COLORS", field:"COLORS", width:100, hozAlign:"center"},
            {title:"STRATEGY", field:"STRATEGY", width:110, hozAlign:"center"},
        ],
      })
        //end if data successfully returned
        })
        .withFailureHandler((err) => {
        })
        .getData()
      }
    </script>
</head>

<body>
   <div id="data-table"></div>

    
</body>
</html>
